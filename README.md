# Juggler

## Install
1. `git clone https://github.com/daniel-lerch/juggler.git /opt/juggler`
2. Add `/opt/juggler/bin` to _PATH_ permanently for all users

## Manage an application

### Variables
- `PROJECT_DIR` e.g. _/opt/global/nginx_
- `PROJECT_NAME` e.g. _nginx_
- `PROJECT_GROUP` e.g. _global_
- `PROJECT_TITLE` e.g. _global/nginx_
- `COMPOSE_FILE` e.g. _/opt/global/nginx/docker-compose.yml_
- `COMPOSE_PROJECT_NAME` e.g. _global-nginx_
- `APP_CONTAINER_NAME` e.g. _global-nginx-app_

### Functions
- `invoke_composer()` (exposed) Invokes _docker-compose_ with all required options

### Example
Nextcloud (located in `/opt/church/nextcloud`)

- `juggler.env` Custom environment variables
```sh
APP_IMAGE=nextcloud:latest

DB_IMAGE=mariadb:latest
DB_CONTAINER_NAME=$COMPOSE_PROJECT_NAME-db

MYSQL_ROOT_PASSWORD=root
MYSQL_DATABASE=nextcloud
MYSQL_USER=nextcloud
MYSQL_PASSWORD=password
```
- `.env` Environment file generated by Juggler
- `docker-compose.yml` Compose file template using variables
```yaml
version: '2.1'

services:
  app:
    image: ${APP_IMAGE}
    container_name: ${APP_CONTAINER_NAME}
    environment:
      - MYSQL_DATABASE
      - MYSQL_USER
      - MYSQL_PASSWORD
      - MYSQL_HOST=db
  db:
    image: ${DB_IMAGE}
    container_name: ${DB_CONTAINER_NAME}
    environment:
      - MYSQL_ROOT_PASSWORD
      - MYSQL_DATABASE
      - MYSQL_USER
      - MYSQL_PASSWORD
```
- `juggler_include.sh` Implement custom functions
```bash
function cmd_execw() {
    invoke_composer exec -u www-data app bash
}
```
